#include "DbWaveletGrid.h"
#include "tools/Exception.h"

namespace PLMD {
namespace ves {

// returns the filter coefficients, at the moment simply a lookup table (calculated with python script)
std::vector<double> DbWaveletGrid::get_filter_coefficients(const unsigned order) {
  std::vector<double> h;
  switch(order) {
  case 4:
    h = { 0.16290171402564917413726008653520,
          0.50547285754591464446150439471239,
          0.44610006912337984985583716479596,
          -0.01978751311782261934624216337397,
          -0.13225358368451997637116335226892,
          0.02180815023708870120655589630587,
          0.02325180053549090811171318193828,
          -0.00749349466518074713849983936598
        };
    break;
  case 5:
    h = { 0.11320949129177913794475074382717,
          0.42697177135251407342764196073404,
          0.51216347212959856260994229160133,
          0.09788348067390491291650533867141,
          -0.17132835769146739779422716765112,
          -0.02280056594177386902755344522120,
          0.05485132932106674685801550594988,
          -0.00441340005417907230156338016513,
          -0.00889593505097708084350394130979,
          0.00235871396953392896411738632878
        };
    break;
  case 6:
    h = { 0.07887121600145079181043428206976,
          0.34975190703761821486850180917827,
          0.53113187994086930032722193573136,
          0.22291566146501751166653093605419,
          -0.15999329944606191511446979802713,
          -0.09175903203014772191448145122195,
          0.06894404648737242902178934400581,
          0.01946160485416470464770100079477,
          -0.02233187416509457498547952525314,
          0.00039162557614857556329349130841,
          0.00337803118146394248597075282703,
          -0.00076176690280125431125463064674
        };
    break;
  case 7:
    h = { 0.05504971537281189153389959756169,
          0.28039564181276277476939640109777,
          0.51557424581809907504492684893194,
          0.33218624110553995887329392644460,
          -0.10175691123134643356618056486695,
          -0.15841750564033332815405685778387,
          0.05042323250469382678318197577028,
          0.05700172257987153046077111184786,
          -0.02689122629484543350320002730314,
          -0.01171997078210329154557278741322,
          0.00887489618968076258986865667566,
          0.00030375749770106871133767967308,
          -0.00127395235909368671409214179846,
          0.00025011342656124530567721131469
        };
    break;
  case 8:
    h = { 0.03847781105407625107384106399877,
          0.22123362357612499917713932973129,
          0.47774307521387382458044612576487,
          0.41390826621119614081578674813500,
          -0.01119286766688032223882043325602,
          -0.20082931639048942629166560891463,
          0.00033409704621987986209938337190,
          0.09103817842365775903079594399969,
          -0.01228195052284831653710561738535,
          -0.03117510332513940760068571478314,
          0.00988607964835074015663707314161,
          0.00618442240981591576098885809643,
          -0.00344385962844180560857298978306,
          -0.00027700227447938875020502780266,
          0.00047761485564962581715914291536,
          -0.00008306863068661268778569706228
        };
    break;
  case 9:
    h = { 0.02692517479466279006761197933884,
          0.17241715190697787241091987198160,
          0.42767453217970741174980275900452,
          0.46477285718314720330823774929740,
          0.09418477475318376423985000656103,
          -0.20737588090093830861526669195882,
          -0.06847677451238293189206274291791,
          0.10503417113950619388162976974854,
          0.02172633773061449086183571921538,
          -0.04782363206009698081144776438123,
          0.00017744640661656197605511309234,
          0.01581208292625586528390435603342,
          -0.00333981011313858695485623506727,
          -0.00302748028754506841309090958703,
          0.00130648364024724713931824293667,
          0.00016290733567609242218345022568,
          -0.00017816487951077784337126919123,
          0.00002782275701715486649267736197
        };
    break;
  case 10:
    h = { 0.01885857879612070839292492507866,
          0.13306109139692101628327236539917,
          0.37278753574323358899178515457606,
          0.48681405536682004209225738122768,
          0.19881887088450819756069165578083,
          -0.17666810089705686781513804817223,
          -0.13855493936048302039409918506863,
          0.09006372426669713437963338265035,
          0.06580149355053510618063228321262,
          -0.05048328559838994450403859559628,
          -0.02082962404380086715582898193588,
          0.02348490704869863471282442901611,
          0.00255021848390725100474973885412,
          -0.00758950116792827221556816397197,
          0.00098666268248160217749220812777,
          0.00140884329509734229635142810366,
          -0.00048497391992820618189519166208,
          -0.00008235450304538928425340804651,
          0.00006617718342555348697269640423,
          -0.00000937920781375021304763529850
        };
    break;
  case 11:
    h = { 0.01321886471665671691777532714696,
          0.10187076760095251093396484520781,
          0.31812717423038988640016100362118,
          0.48485376831317977819324482879892,
          0.29130279889030213924527856761415,
          -0.11474592617764799162838329493752,
          -0.19391049139550065039117043852457,
          0.04669986906776670693153263869135,
          0.10593308991818059516809569231555,
          -0.03286629145225358067383680804596,
          -0.04697931589875246893850402329917,
          0.02215725478297956782536282105411,
          0.01473674479914440470229575197436,
          -0.01086456905449193280355224544564,
          -0.00236234396409578002729023893380,
          0.00348491754511884906791996385778,
          -0.00021820810309392619976559535289,
          -0.00063146279630336900768466934508,
          0.00017617743895394181595677463026,
          0.00003849423888144447265325168162,
          -0.00002449063218490587595611504557,
          0.00000317793181794619827328150612
        };
    break;
  case 12:
    h = { 0.00927176651822425590410148288356,
          0.07747505450119530900909836645951,
          0.26683037502553619280121210977086,
          0.46470967332296447827033603061864,
          0.36478682721875621552953816717491,
          -0.03165284709804231516594441586676,
          -0.22357192871367079223254847875069,
          -0.01681447405734636663110492804662,
          0.12903185967285815682892291533790,
          0.00378978806097531734087269228439,
          -0.06818780604443562542993362285415,
          0.00767149357386833711386353584771,
          0.02937765454983226262597462152826,
          -0.00863988961415779535557568635795,
          -0.00907983457374947691698174878638,
          0.00474574646104613823843765274546,
          0.00159000542833290605705676146187,
          -0.00154114178835231398038974059972,
          0.00000462810454280184750724047235,
          0.00027481921624960246614693959444,
          -0.00006258185578399625542938417011,
          -0.00001714136139124045415623766309,
          0.00000903466955721996056261156177,
          -0.00000108121700905108317324195780
        };
    break;
  case 13:
    h = { 0.00650689102678443914012929027990,
          0.05859174744008171370479587380942,
          0.22061471510490821001937433720741,
          0.43208173603809618690263505413895,
          0.41640780862194820555188812249980,
          0.06150819684806563270029755585711,
          -0.22271947893276758390079805849382,
          -0.08808905109195373783759208663469,
          0.12690875282526051237574904462235,
          0.05158268566903553842273311147437,
          -0.07481728432188405886194004779099,
          -0.01873013184154090349231580603373,
          0.03969660494987694437929448554314,
          0.00168289451988089125769598730642,
          -0.01685135918957933812145633112323,
          0.00277464560742358545136765357597,
          0.00513047646738900089968815620978,
          -0.00195296616306116352021482462931,
          -0.00093032194492927340351978715560,
          0.00065925412941365444871588685771,
          0.00003482608740057909206978142835,
          -0.00011676382757878021043714683591,
          0.00002169300195922720778693264243,
          0.00000738355991572178164110027906,
          -0.00000332369636695704536442138449,
          0.00000036911222161491935499382281
        };
    break;
  case 14:
    h = { 0.00456872542591511051485175798348,
          0.04409854388947367920259523543791,
          0.18020635254337002972846448756172,
          0.39195326129580521090645106596639,
          0.44631720830459503668308229862305,
          0.15462352616104876878999618838861,
          -0.19211281768705798511653881632810,
          -0.15417298758428499283468227076810,
          0.09786019420756764120028492470738,
          0.09898718291850779060769838224587,
          -0.06134039007701476420297836966711,
          -0.05059275162372545847633276139277,
          0.03905854655114948670302510436159,
          0.01907873678048828749997944953520,
          -0.02134426676671016126496382980804,
          -0.00397043959961379273188031291397,
          0.00904353741656407222881952634452,
          -0.00052765650756183136819987833377,
          -0.00272210574869779500448152553815,
          0.00075072896615784848097646664300,
          0.00050064655938346878938371986578,
          -0.00027353149312458774778528125537,
          -0.00002954097378352761769861219154,
          0.00004861715681159360267441643666,
          -0.00000730951071295384714998069273,
          -0.00000310399010345745585934566432,
          0.00000121975543246326800569533273,
          -0.00000012636987905224731868382567
        };
    break;
  case 15:
    h = { 0.00320923054504093641092765665235,
          0.03305257150435561563917019611836,
          0.14568087131145940338328159668890,
          0.34834326640276819242458827829978,
          0.45665885092611357976011277060024,
          0.23971099165947296061318638749071,
          -0.13661595727093933660967195464764,
          -0.20427084299927872335089773514483,
          0.04616201865524952735464481179406,
          0.13445403089477661606743197353353,
          -0.02804822242634184836784783101393,
          -0.07857436740372289452061238534952,
          0.02395475819554471891281721696032,
          0.03873569879543788119224956290054,
          -0.01822002561282331373204712576808,
          -0.01471492759182226398029236236198,
          0.01066594072434465419185745105324,
          0.00360695194567915104061350817233,
          -0.00458752110213754213385861646657,
          -0.00017094765401337423411237681492,
          0.00137413756457069411581750628670,
          -0.00026409190526422885673257789918,
          -0.00025425102256769905456623703799,
          0.00011023546518603688482672298132,
          0.00001823819247783039029396287556,
          -0.00001989324456685262723274441876,
          0.00000237799104125010208658449508,
          0.00000128076158801730623817667978,
          -0.00000044667103285883894560847045,
          0.00000004336940386156252247026332
        };
    break;
  case 16:
    h = { 0.00225511974301538520304433177444,
          0.02468348151399175904874283560275,
          0.11671807418666441114041276705393,
          0.30427704435524999260209710882918,
          0.45067898444862103390917695833195,
          0.31133222633470181150983080442529,
          -0.06346360393537413269182678732250,
          -0.23126868475159076399272350954561,
          -0.01974115428942194161443524080823,
          0.14933437181349287770082412407646,
          0.01933248589896373673124863046269,
          -0.09361266861397692096158351660051,
          -0.00441215027100251566682942439002,
          0.05368654216331579520637973246266,
          -0.00536621523846921022471434525869,
          -0.02608403615492724952895642331896,
          0.00728154496247164668976115109444,
          0.00989508885514186510568013233069,
          -0.00494268669838292176027527702331,
          -0.00257689483290143373298008988570,
          0.00221184654456105982481273208862,
          0.00028842672118433202669424142428,
          -0.00066540286021618511805991724728,
          0.00008078095351244477819417644238,
          0.00012359324636375328501126935610,
          -0.00004315894560627075142054606682,
          -0.00000986107710974538496007026772,
          0.00000801619286004670152730351707,
          -0.00000073791637280051035189566699,
          -0.00000052068916473229240577758146,
          0.00000016325568841125834120819589,
          -0.00000001491528356269781642685758
        };
    break;
  case 17:
    h = { 0.00158519693254499292010828437327,
          0.01837444809962244032797151760406,
          0.09278294792170199700720445434854,
          0.26187750846568830231930746776925,
          0.43203985023264240838969385549717,
          0.36650459156056569565151903589140,
          0.01931460080008802829287795077562,
          -0.23215782757241043565699101236532,
          -0.08951954328841366104185794938530,
          0.13951965588131051698717044473597,
          0.07151359021599888732279026726246,
          -0.08967223561728308867113668156890,
          -0.04036972996911385169749308943210,
          0.05735059315798946011355496921169,
          0.01577720421564969555117130539657,
          -0.03317917437486412463032436903632,
          -0.00231291484033912348936001812660,
          0.01607513687381053463232305489328,
          -0.00215171885089820817682504383583,
          -0.00608318414503595389364321022185,
          0.00209869058711733115843434127612,
          0.00162719783162881305449420921150,
          -0.00101600305854224496823756673791,
          -0.00023202472960252924403211360893,
          0.00031074898407225723514710202799,
          -0.00001810908214143632476156309252,
          -0.00005801671982755953951979219219,
          0.00001639555327120307762081910519,
          0.00000494310136111718310313262528,
          -0.00000318618248128089387349501892,
          0.00000021330226850127661865091260,
          0.00000020914103866701402628154203,
          -0.00000005956631070534388811070866,
          0.00000000513889356029547011613019
        };
    break;
  case 18:
    h = { 0.00111461964471306685699192318140,
          0.01363905158127520084176964587641,
          0.07324810663574350677595958813981,
          0.22251161331600882720138656623021,
          0.40434261343600524929442485699838,
          0.40432482766543759167277016786102,
          0.10410246082132777745155038928715,
          -0.20764476352761609967423339639936,
          -0.15307513643259529345641567488201,
          0.10573648814006794682818224373477,
          0.11814432926442487714613349680803,
          -0.06528850140281516889473323317361,
          -0.07548523752006205955744633229187,
          0.04588219059576607167239004070325,
          0.04034132415107608005122585836943,
          -0.03148473687967528328313093766155,
          -0.01678191401024060891433720144050,
          0.01885903701963950046538442961719,
          0.00442802142541854053953143122158,
          -0.00922879068187630775821350681554,
          0.00008388410139358127366911166423,
          0.00349547178516063745609687707372,
          -0.00079106345516537419394753616331,
          -0.00094794473338704471343518775939,
          0.00044439234616770159668266981789,
          0.00015102497076321391039112340682,
          -0.00014046573841252965315733181040,
          -0.00000010860574133812851161630592,
          0.00002645454675503289200966944295,
          -0.00000602497583402408805325475502,
          -0.00000235652843923625415946268916,
          0.00000125066894469579706336884693,
          -0.00000005438805633414307765849166,
          -0.00000008316274135108063972706181,
          0.00000002169994649107741804050337,
          -0.00000000177337745986556742188355
        };
    break;
  case 19:
    h = { 0.00078394790764231352900998084365,
          0.01009826155732878108506334058347,
          0.05747230505205819933722821701849,
          0.18695085295127644720025728020119,
          0.37083251880618839368963790548150,
          0.42546936695889686630422943380836,
          0.18448059019687873538728695166355,
          -0.16128497158012364276480354874366,
          -0.20211843483969027523983186256373,
          0.05278712614157797522462800543508,
          0.15015394347516955453336606751691,
          -0.02370118827454988433278693094053,
          -0.10096473321834775749294976776582,
          0.01950508138195812188331323966395,
          0.06145235618442058261878813141266,
          -0.01873920386227236750675828602652,
          -0.03229655512606567635547349937042,
          0.01529031257011830360892368219083,
          0.01370058271585176609685952087148,
          -0.00989128449246658852933578032207,
          -0.00414854052959869219752153668423,
          0.00497856020790146940740994452312,
          0.00054373284185436627884147053891,
          -0.00190038610306606198067924662354,
          0.00024169521672873488932209440350,
          0.00052029095186352167234922205807,
          -0.00018432586323184185078671859515,
          -0.00008810606477643538180389432002,
          0.00006159798420120859562421761213,
          0.00000361045221381339109567630910,
          -0.00001176638149985729096705204533,
          0.00000212907328596377065494629939,
          0.00000108323913548142837054389861,
          -0.00000048527010632346051254351876,
          0.00000001023245949055384503133563,
          0.00000003278810145195796522598770,
          -0.00000000789415472131667509587225,
          0.00000000061283875855736142533319
        };
    break;
  case 20:
    h = { 0.00055151048923486839341279175386,
          0.00745954847671665907671290085545,
          0.04484738525111215540208675633949,
          0.15552255996072858468259880737605,
          0.33424667807443436684522453106183,
          0.43168390912213921994933230052993,
          0.25562072685317310805075408097764,
          -0.09843781145616527228359160517357,
          -0.23107316258942961484379452485882,
          -0.01182783757307890280807693983434,
          0.16142615011898048260619020766171,
          0.02817837950244600139781958603180,
          -0.10992593681973013286512497188596,
          -0.01747743622052526368815250634725,
          0.07233116828742387760531329377045,
          0.00398259994606550964818536542111,
          -0.04364468087913949551071013388537,
          0.00415402734643627140342925230243,
          0.02283551819188689088746535560404,
          -0.00621499125572978327464168657457,
          -0.00976551668333081740458467834287,
          0.00475290824603444815588115801575,
          0.00312579549840199177532240604194,
          -0.00253249887775045456547728939256,
          -0.00058800325138124733513611541724,
          0.00098468835002980120707505307109,
          -0.00003782851463403440048964901377,
          -0.00027231017927233417373622526014,
          0.00007179459484626479911194285588,
          0.00004790139911407762391684292402,
          -0.00002623780652454990407456553170,
          -0.00000309440100039889046898986327,
          0.00000512033576846877436109049114,
          -0.00000071558782700428415654391031,
          -0.00000048416164143627272294995645,
          0.00000018624656815267224392406288,
          0.00000000014243407623741313384272,
          -0.00000001283287967663174522311048,
          0.00000000286811494633447015293831,
          -0.00000000021204976174791129176822
        };
    break;
  default:
    plumed_merror("Specified order currently not implemented");
  }
  return h;
}


}
}
